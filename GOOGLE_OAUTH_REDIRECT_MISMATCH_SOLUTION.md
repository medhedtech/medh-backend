# üö® Google OAuth redirect_uri_mismatch - DEFINITIVE SOLUTION

## ‚úÖ **CONFIRMED ISSUE**

Your backend is generating: `http://localhost:8080/api/v1/auth/oauth/google/callback`
But this exact URI is **NOT registered** in your Google Cloud Console.

## üéØ **SOLUTION 1: Fix Existing OAuth Client (Recommended)**

### **Step 1: Access Your OAuth Client**

**Direct Link:** https://console.cloud.google.com/apis/credentials/oauthclient/319534674928-7dpmmo944cal0v2pkvr9omes7fkfri3r

### **Step 2: Add EXACT Redirect URIs**

In the **"Authorized redirect URIs"** section, click **"+ ADD URI"** and add:

```
http://localhost:8080/api/v1/auth/oauth/google/callback
```

### **Step 3: Add JavaScript Origins**

In the **"Authorized JavaScript origins"** section, click **"+ ADD URI"** and add:

```
http://localhost:8080
```

### **Step 4: Save and Wait**

- Click **SAVE**
- Wait **5-10 minutes** for changes to propagate
- Test: `http://localhost:8080/api/v1/auth/oauth/google`

---

## üî• **SOLUTION 2: Create New OAuth Client (If Above Fails)**

### **Step 1: Go to Google Cloud Console**

https://console.cloud.google.com/apis/credentials

### **Step 2: Create New OAuth 2.0 Client ID**

1. Click **"+ CREATE CREDENTIALS"**
2. Select **"OAuth 2.0 Client ID"**
3. Choose **"Web application"**

### **Step 3: Configure EXACTLY**

```
Name: MEDH Backend OAuth Fixed

Authorized JavaScript origins:
http://localhost:8080

Authorized redirect URIs:
http://localhost:8080/api/v1/auth/oauth/google/callback
```

### **Step 4: Update .env File**

Replace your current credentials:

```env
# Replace these values
GOOGLE_CLIENT_ID=your_new_client_id.apps.googleusercontent.com
GOOGLE_CLIENT_SECRET=your_new_client_secret
```

### **Step 5: Restart Server**

```bash
# Stop server (Ctrl+C)
npm start
```

---

## üîç **WHY THIS HAPPENS (Based on Research)**

1. **Google is extremely strict** about redirect URI matching
2. **Even trailing slashes matter** - `callback` vs `callback/`
3. **Protocol matters** - `http` vs `https`
4. **Port numbers matter** - `:8080` must be included
5. **Case sensitivity** - exact capitalization required

---

## üìã **COMMON VARIATIONS TO TRY**

If the exact URI doesn't work, try adding ALL these variations:

```
http://localhost:8080/api/v1/auth/oauth/google/callback
http://localhost:8080/api/v1/auth/oauth/google/callback/
http://127.0.0.1:8080/api/v1/auth/oauth/google/callback
http://127.0.0.1:8080/api/v1/auth/oauth/google/callback/
```

**JavaScript Origins:**

```
http://localhost:8080
http://127.0.0.1:8080
```

---

## ‚úÖ **VERIFICATION STEPS**

### **Test 1: Check Backend Response**

```bash
curl -I http://localhost:8080/api/v1/auth/oauth/google
```

Should redirect to Google without error.

### **Test 2: Browser Test**

Open: `http://localhost:8080/api/v1/auth/oauth/google`
Should show Google consent screen, not error page.

### **Test 3: Check OAuth Endpoint**

```bash
curl -s http://localhost:8080/api/v1/auth/oauth/providers | jq '.data.providers[] | select(.provider=="google")'
```

Should return Google provider configuration.

---

## üö® **IF STILL NOT WORKING**

### **Check OAuth Consent Screen**

1. Go to: https://console.cloud.google.com/apis/credentials/consent
2. Ensure OAuth consent screen is configured
3. Add test users if needed
4. Publish app or add your email as test user

### **Check API Enablement**

1. Go to: https://console.cloud.google.com/apis/library
2. Enable "Google+ API" or "People API"
3. Enable "Google OAuth2 API"

### **Check Project Selection**

- Ensure you're in the correct Google Cloud project
- Check project ID matches your expectations

---

## üéâ **SUCCESS INDICATORS**

‚úÖ No more "redirect_uri_mismatch" error  
‚úÖ Google consent screen appears  
‚úÖ User can authorize and login  
‚úÖ Backend receives OAuth callback successfully

---

## üìû **EMERGENCY BACKUP PLAN**

If nothing works, create a completely fresh Google Cloud project:

1. New project ‚Üí Enable APIs ‚Üí Create OAuth client ‚Üí Test

This eliminates any configuration conflicts from previous attempts.

---

**üîë KEY TAKEAWAY:** The backend code is perfect. This is 100% a Google Cloud Console configuration issue. The exact redirect URI generated by your backend must be registered in Google Cloud Console.
